{"version":3,"file":"index.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nclass Sprite extends karas.Component {\n  constructor(props) {\n    super(props);\n    this.count = 0;\n    this.times = 0;\n    this.playbackRate = props.playbackRate || 1;\n  }\n\n  componentDidMount() {\n    let { nw, nh, delay = 0, duration = 1000, iterations = 1, fill, autoPlay } = this.props;\n    let total = nw * nh;\n    let sr = this.shadowRoot;\n    let cb = this.cb = diff => {\n      this.count += diff * this.playbackRate;\n      if(this.times === 0 && this.count < delay) {\n        return;\n      }\n      let time = this.times ? this.count : (this.count - delay);\n      if(time >= duration) {\n        this.times++;\n        if(this.times >= iterations) {\n          sr.removeFrameAnimate(cb);\n          let backgroundPosition = ['forwards', 'both'].indexOf(fill) > -1 ? '100% 100%' : '1000% 1000%';\n          sr.updateStyle({\n            backgroundPosition,\n          });\n          return;\n        }\n        this.count = time - duration;\n      }\n      let i = Math.floor(time * total / duration);\n      sr.updateStyle({\n        backgroundPositionX: i % nw / (nw - 1) * 100 + '%',\n        backgroundPositionY: Math.floor(i / nw) / (nh - 1) * 100 + '%',\n      });\n    };\n    if(autoPlay !== false) {\n      sr.frameAnimate(cb);\n    }\n  }\n\n  play() {\n    this.count = 0;\n    this.times = 0;\n    this.resume();\n  }\n\n  pause() {\n    this.shadowRoot.removeFrameAnimate(this.cb);\n  }\n\n  resume() {\n    this.shadowRoot.frameAnimate(this.cb);\n  }\n\n  render() {\n    let nw = this.props.nw, nh = this.props.nh, fill = this.props.fill;\n    let backgroundPosition = ['backwards', 'both'].indexOf(fill) > -1 ? '0 0' : '1000% 1000%';\n    return <div style={{\n      backgroundRepeat: 'no-repeat',\n      backgroundPosition,\n      backgroundSize: `${nw * 100}% ${nh * 100}%`,\n    }}/>;\n  }\n}\n\nSprite.version = version;\n\nexport default Sprite;\n"],"names":["Sprite","props","count","times","playbackRate","nw","nh","delay","duration","iterations","fill","autoPlay","total","sr","shadowRoot","cb","diff","time","removeFrameAnimate","backgroundPosition","indexOf","updateStyle","i","Math","floor","backgroundPositionX","backgroundPositionY","frameAnimate","resume","karas","backgroundRepeat","backgroundSize","Component","version"],"mappings":"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"}