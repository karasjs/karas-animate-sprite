{"version":3,"file":"index.js","sources":["src/index.js"],"sourcesContent":["import karas from 'karas';\nimport { version } from '../package.json';\n\nclass Sprite extends karas.Component {\n  componentDidMount() {\n    let { nw, nh, delay = 0, duration = 1000, iterations = 1, fill } = this.props;\n    let total = nw * nh, count = 0, times = 0;\n    let sr = this.shadowRoot;\n    function cb(diff) {\n      count += diff;\n      if(times === 0 && count < delay) {\n        if(['backwards', 'both'].indexOf(fill) > -1) {\n          sr.updateStyle({\n            visibility: 'inherit',\n            backgroundPositionX: 0,\n            backgroundPositionY: 0,\n          });\n        }\n        return;\n      }\n      let time = times ? count : (count - delay);\n      if(time >= duration) {\n        times++;\n        if(times >= iterations) {\n          sr.removeFrameAnimate(cb);\n          let visibility = ['forwards', 'both'].indexOf(fill) > -1 ? 'visible' : 'hidden';\n          sr.updateStyle({\n            visibility,\n            backgroundPositionX: 0,\n            backgroundPositionY: 0,\n          });\n          return;\n        }\n        count = time - duration;\n      }\n      let i = Math.floor(time * total / duration);\n      sr.updateStyle({\n        visibility: 'inherit',\n        backgroundPositionX: i % nw / (nw - 1) * 100 + '%',\n        backgroundPositionY: Math.floor(i / nw) / (nh - 1) * 100 + '%',\n      });\n    }\n    sr.frameAnimate(cb);\n  }\n\n  render() {\n    let nw = this.props.nw, nh = this.props.nh;\n    return <div style={{\n      visibility: 'hidden',\n      backgroundRepeat: 'no-repeat',\n      backgroundPosition: '0 0',\n      backgroundSize: `${nw * 100}% ${nh * 100}%`,\n    }}/>;\n  }\n}\n\nSprite.version = version;\n\nexport default Sprite;\n"],"names":["Sprite","props","nw","nh","delay","duration","iterations","fill","total","count","times","sr","shadowRoot","cb","diff","indexOf","updateStyle","visibility","backgroundPositionX","backgroundPositionY","time","removeFrameAnimate","i","Math","floor","frameAnimate","karas","backgroundRepeat","backgroundPosition","backgroundSize","Component","version"],"mappings":"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"}